---
title: トラブルシューティング
menu:
  docs:
    weight: 120
    parent: admin
---


## **"Something went wrong"というエラーが表示されました。何が起こっているのか調べる方法は？**

スタックトレースを含む、全てのエラーメッセージはシステムログに記録されます。systemdを使用している場合は、`journalctl -u mastodon-web`（実際のサービス名に置き換えてください）コマンドでサービスごとのログを見ることができます。Dockerを使用している場合は、 `docker logs mastodon_web_1`（実際のコンテナ名に置き換えてください） コマンドを使用します。

詳細なサーバーサイドのエラーメッセージは _一切_ 公のページには出力されません。そうしてしまうと、サーバーの設定などの内部情報を悪意のある攻撃者に知らせてしまうことになり、システムを攻撃する足掛かりを与えてしまうことになりかねないからです。

MastodonのWebサーバーからのレスポンスには一意のリクエストIDが含まれ、それもログに記録されます。エラーページのヘッダーを調べることで、ログから対応するスタックトレースを探しやすくなります。


## **新しいバージョンにアップグレードした後、いくつかのページの表示がおかしくなりました。スタイルが適用されていないように見えます。なぜですか？**

アップグレード後、`RAILS_ENV=production bin/rails assets:precompile` を実行し、MastodonのWebプロセスを再起動したことを確認してください。おそらく古いスタイルシートやスクリプトを使っているためだと思われます。その他の可能性として、メモリ不足でプリコンパイルに失敗しているかもしれません。Webpackはかなりメモリ食いです。そのような場合は、より多くのスワップ領域を確保してください。もしくは、他のマシンでアセットをプリコンパイルし、`public/packs` ディレクトリをまるごとコピーすることで対応できます。

## **新しいバージョンにアップグレードした後、いくつかのリクエストが失敗し、ログにカラムやテーブルが見つからないといったメッセージが記録されます。なぜですか？**

アップグレード後、`RAILS_ENV=production bin/rails db:migrate` を実行したことを確認してください。おそらくMastodonのプログラムが新しい、もしくは古いデータベーススキーマに対してアクセスをしようとしているためだと思われます。PgBouncerを使っている場合は、マイグレーションに使用するテーブルロックをサポートしていないため、このコマンドが直接PostgreSQLに届くようにしてください。

## **`tootctl`や`rake`/`rails`といったコマンドを実行しようとしていますが、"uninitialized constants"エラーが出ます。どうなってますか？**

コマンドの前に`RAILS_ENV=production`を付けるなどして、正しい環境に対して実行しようとしたか確認してください。デフォルトでは、開発（development）環境に対して実行しようとするので、プログラムは開発環境用のgemを使おうとします。しかし、本番（production）環境においてはそれらのgemをインストールしないようにしているので、そのようなエラーが表示されます。

